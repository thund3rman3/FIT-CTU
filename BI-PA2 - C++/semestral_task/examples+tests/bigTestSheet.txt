
    CSpreadsheet x0, x1;
    std::ostringstream oss;
    std::istringstream iss;
    std::string data;

    assert (x0.setCell(CPos("F8"), "50"));
    assert (x0.setCell(CPos("F9"), "10"));
    assert (x0.setCell(CPos("F10"), "10"));
    assert (x0.setCell(CPos("F11"), "=10"));
    assert (x0.setCell(CPos("F12"), "10"));
    assert (x0.setCell(CPos("F13"), "abc"));
    assert (x0.setCell(CPos("F14"), "4"));
    assert (x0.setCell(CPos("F15"), "200"));
    assert (x0.setCell(CPos("F16"), "=0"));
    assert (x0.setCell(CPos("F17"), "=F8-F9"));
    assert (x0.setCell(CPos("F18"), "=F9-F10"));
    assert (x0.setCell(CPos("F19"), "=F10-F11"));
    assert (x0.setCell(CPos("F20"), "=F11-F12"));
    assert (x0.setCell(CPos("F21"), "=F12-F13"));
    assert (x0.setCell(CPos("F22"), "=F13-F14"));
    assert (x0.setCell(CPos("F23"), "=F14-F15"));
    assert (x0.setCell(CPos("F24"), "=F15-F16"));
    assert (x0.setCell(CPos("F25"), "=F16-F17"));
    assert (x0.setCell(CPos("F26"), "=F17-F18"));


    assert (x0.setCell(CPos("G9"), "=F8 + I8"));
    assert (x0.setCell(CPos("G10"), "=F9 + I9"));
    assert (x0.setCell(CPos("G11"), "=F10 + I10"));
    assert (x0.setCell(CPos("G12"), "=F11 + I11"));
    assert (x0.setCell(CPos("G13"), "=F12 + I12"));
    assert (x0.setCell(CPos("G14"), "=F13 + I13"));
    assert (x0.setCell(CPos("G15"), "=F14 + I14"));
    assert (x0.setCell(CPos("G16"), "=F15 + I15"));
    assert (x0.setCell(CPos("G17"), "=F16 + I16"));
    assert (x0.setCell(CPos("G18"), "=F17 + I17"));
    assert (x0.setCell(CPos("G19"), "=F18 + I18"));
    assert (x0.setCell(CPos("G20"), "=F19 + I19"));
    assert (x0.setCell(CPos("G21"), "=F20 + I20"));
    assert (x0.setCell(CPos("G22"), "=F21 + I21"));
    assert (x0.setCell(CPos("G23"), "=F22 + I22"));
    assert (x0.setCell(CPos("G24"), "=F23 + I23"));
    assert (x0.setCell(CPos("G25"), "=F24 + I24"));
    assert (x0.setCell(CPos("G26"), "=F25 + I25"));
    assert (x0.setCell(CPos("G27"), "450"));

    assert (x0.setCell(CPos("H9"), "aaa"));
    assert (x0.setCell(CPos("H15"), "40"));
    assert (x0.setCell(CPos("H16"), "=J16"));
    assert (x0.setCell(CPos("H17"), "=J14"));
    assert (x0.setCell(CPos("H18"), "ccc"));
    assert (x0.setCell(CPos("H19"), "1"));
    assert (x0.setCell(CPos("H20"), "0"));
    assert (x0.setCell(CPos("H21"), "=L23"));
    assert (x0.setCell(CPos("H22"), "10"));
    assert (x0.setCell(CPos("H23"), "60"));

    assert (x0.setCell(CPos("I8"), "=I16+K19"));
    assert (x0.setCell(CPos("I9"), "=I17+K20"));
    assert (x0.setCell(CPos("I10"), "=K10"));
    assert (x0.setCell(CPos("I11"), "=L24"));
    assert (x0.setCell(CPos("I12"), "=L20"));
    assert (x0.setCell(CPos("I13"), "=J25"));
    assert (x0.setCell(CPos("I14"), "=F15"));
    assert (x0.setCell(CPos("I15"), "=M17"));
    assert (x0.setCell(CPos("I16"), "=K19"));
    assert (x0.setCell(CPos("I17"), "=I18"));
    assert (x0.setCell(CPos("I18"), "-5"));
    assert (x0.setCell(CPos("I19"), "1"));
    assert (x0.setCell(CPos("I20"), "1"));
    assert (x0.setCell(CPos("I21"), "\n jaj \n \n"));
    assert (x0.setCell(CPos("I22"), "3"));
    assert (x0.setCell(CPos("I23"), "1"));
    assert (x0.setCell(CPos("I24"), "1"));
    assert (x0.setCell(CPos("I25"), "3"));
    assert (x0.setCell(CPos("I26"), "1"));
    assert (x0.setCell(CPos("I27"), "1"));

    assert (x0.setCell(CPos("J9"), "11"));
    assert (x0.setCell(CPos("J10"), "=$F11^K10"));
    assert (x0.setCell(CPos("J11"), "=$F12^K11"));
    assert (x0.setCell(CPos("J12"), "=$F13^K12"));
    assert (x0.setCell(CPos("J13"), "=$F14^$K13"));
    assert (x0.setCell(CPos("J14"), "3"));
    assert (x0.setCell(CPos("J15"), "=$G18*$M13"));
    assert (x0.setCell(CPos("J16"), "=$G19*$M14"));
    assert (x0.setCell(CPos("J17"), "=$G20*$M15"));
    assert (x0.setCell(CPos("J18"), "=$G21*$M16"));
    assert (x0.setCell(CPos("J19"), "=I$10 - F$14"));
    assert (x0.setCell(CPos("J20"), "=I$10 - F$14"));
    assert (x0.setCell(CPos("J21"), "=I$10 - F$14"));
    assert (x0.setCell(CPos("J22"), "=I$10 - F$14"));
    assert (x0.setCell(CPos("J23"), "=I$10 - F$14"));
    assert (x0.setCell(CPos("J24"), "=I$10 - F$14"));
    assert (x0.setCell(CPos("J25"), "90"));

    assert (x0.setCell(CPos("K6"), "0"));
    assert (x0.setCell(CPos("K10"), "12"));
    assert (x0.setCell(CPos("K11"), "100"));
    assert (x0.setCell(CPos("K12"), "0"));
    assert (x0.setCell(CPos("K13"), "1"));
    assert (x0.setCell(CPos("K14"), "2"));
    assert (x0.setCell(CPos("K15"), "3"));
    assert (x0.setCell(CPos("K16"), "4"));
    assert (x0.setCell(CPos("K17"), "5"));
    assert (x0.setCell(CPos("K18"), "6"));
    assert (x0.setCell(CPos("K19"), "brrr"));
    assert (x0.setCell(CPos("K20"), "=$I$14 + $K14 + G$18 + $F14"));
    assert (x0.setCell(CPos("K21"), "=$I$14 + $K15 + G$18 + $F15"));
    assert (x0.setCell(CPos("K22"), "=$I$14 + $K16 + G$18 + $F16"));
    assert (x0.setCell(CPos("K23"), "=$I$14 + $K17 + G$18 + $F17"));
    assert (x0.setCell(CPos("K24"), "455"));

    assert (x0.setCell(CPos("L10"), "12"));
    assert (x0.setCell(CPos("L11"), "14"));
    assert (x0.setCell(CPos("L12"), "45"));
    assert (x0.setCell(CPos("L13"), "20"));
    assert (x0.setCell(CPos("L14"), "=$I$19 /$J$19"));
    assert (x0.setCell(CPos("L15"), "=$I$19 /$J$19"));
    assert (x0.setCell(CPos("L16"), "=$I$19 /$J$19"));
    assert (x0.setCell(CPos("L17"), "=K$10 - $G11"));
    assert (x0.setCell(CPos("L18"), "=K$10 - $G12"));
    assert (x0.setCell(CPos("L19"), "=K$10 - $G13"));
    assert (x0.setCell(CPos("L20"), "=$I$14 + $K14 + F$18 + J$14"));
    assert (x0.setCell(CPos("L21"), "=$I$14 + $K15 + F$18 + J$14"));
    assert (x0.setCell(CPos("L22"), "=$I$14 + $K16 + F$18 + J$14"));
    assert (x0.setCell(CPos("L23"), "=$I$14 + $K17 + F$18 + F$14"));
    assert (x0.setCell(CPos("L24"), "456"));

    assert (x0.setCell(CPos("M13"), "18"));
    assert (x0.setCell(CPos("M14"), "=M22+I21"));
    assert (x0.setCell(CPos("M18"), "=L$10 - $G12"));
    assert (x0.setCell(CPos("M19"), "=L$10 - $G13"));
    assert (x0.setCell(CPos("M20"), "202"));
    assert (x0.setCell(CPos("M22"), "\n jaj \n \n"));

    //-------------------------------------------------------------------------------------
    assert (valueMatch(x0.getValue(CPos("F8")), CValue(50.0)));
    assert (valueMatch(x0.getValue(CPos("F9")), CValue(10.0)));
    assert (valueMatch(x0.getValue(CPos("F10")), CValue(10.0)));
    assert (valueMatch(x0.getValue(CPos("F11")), CValue(10.0)));
    assert (valueMatch(x0.getValue(CPos("F12")), CValue(10.0)));
    assert (valueMatch(x0.getValue(CPos("F13")), CValue("abc")));
    assert (valueMatch(x0.getValue(CPos("F14")), CValue(4.0)));
    assert (valueMatch(x0.getValue(CPos("F15")), CValue(200.0)));
    assert (valueMatch(x0.getValue(CPos("F16")), CValue(0.0)));
    assert (valueMatch(x0.getValue(CPos("F17")), CValue(40.0)));
    assert (valueMatch(x0.getValue(CPos("F18")), CValue(0.0)));
    assert (valueMatch(x0.getValue(CPos("F19")), CValue(0.0)));
    assert (valueMatch(x0.getValue(CPos("F20")), CValue(0.0)));
    assert (valueMatch(x0.getValue(CPos("F21")), CValue()));
    assert (valueMatch(x0.getValue(CPos("F22")), CValue()));
    assert (valueMatch(x0.getValue(CPos("F23")), CValue(-196.0)));
    assert (valueMatch(x0.getValue(CPos("F24")), CValue(200.0)));
    assert (valueMatch(x0.getValue(CPos("F25")), CValue(-40.0)));
    assert (valueMatch(x0.getValue(CPos("F26")), CValue(40.0)));

    assert (valueMatch(x0.getValue(CPos("G9")), CValue("50.000000brrrbrrr")));
    assert (valueMatch(x0.getValue(CPos("G10")), CValue(246.0)));
    assert (valueMatch(x0.getValue(CPos("G11")), CValue(22.0)));
    assert (valueMatch(x0.getValue(CPos("G12")), CValue(466.0)));
    assert (valueMatch(x0.getValue(CPos("G13")), CValue(215.0)));
    assert (valueMatch(x0.getValue(CPos("G14")), CValue("abc90.000000")));
    assert (valueMatch(x0.getValue(CPos("G15")), CValue(204.0)));
    assert (valueMatch(x0.getValue(CPos("G16")), CValue()));
    assert (valueMatch(x0.getValue(CPos("G17")), CValue("0.000000brrr")));
    assert (valueMatch(x0.getValue(CPos("G18")), CValue(35.0)));
    assert (valueMatch(x0.getValue(CPos("G19")), CValue(-5.0)));
    assert (valueMatch(x0.getValue(CPos("G20")), CValue(1.0)));
    assert (valueMatch(x0.getValue(CPos("G21")), CValue(1.0)));
    assert (valueMatch(x0.getValue(CPos("G22")), CValue()));
    assert (valueMatch(x0.getValue(CPos("G23")), CValue()));
    assert (valueMatch(x0.getValue(CPos("G24")), CValue(-195.0)));
    assert (valueMatch(x0.getValue(CPos("G25")), CValue(201.0)));
    assert (valueMatch(x0.getValue(CPos("G26")), CValue(-37.0)));
    assert (valueMatch(x0.getValue(CPos("G27")), CValue(450.0)));

    assert (valueMatch(x0.getValue(CPos("H9")), CValue("aaa")));
    assert (valueMatch(x0.getValue(CPos("H15")), CValue(40.0)));
    assert (valueMatch(x0.getValue(CPos("H16")), CValue()));
    assert (valueMatch(x0.getValue(CPos("H17")), CValue(3.0)));
    assert (valueMatch(x0.getValue(CPos("H18")), CValue("ccc")));
    assert (valueMatch(x0.getValue(CPos("H19")), CValue(1.0)));
    assert (valueMatch(x0.getValue(CPos("H20")), CValue(0.0)));
    assert (valueMatch(x0.getValue(CPos("H21")), CValue(209.0)));
    assert (valueMatch(x0.getValue(CPos("H22")), CValue(10.0)));
    assert (valueMatch(x0.getValue(CPos("H23")), CValue(60.0)));

    assert (valueMatch(x0.getValue(CPos("I8")), CValue("brrrbrrr")));
    assert (valueMatch(x0.getValue(CPos("I9")), CValue(236.0)));
    assert (valueMatch(x0.getValue(CPos("I10")), CValue(12.0)));
    assert (valueMatch(x0.getValue(CPos("I11")), CValue(456.0)));
    assert (valueMatch(x0.getValue(CPos("I12")), CValue(205.0)));
    assert (valueMatch(x0.getValue(CPos("I13")), CValue(90.0)));
    assert (valueMatch(x0.getValue(CPos("I14")), CValue(200.0)));
    assert (valueMatch(x0.getValue(CPos("I15")), CValue()));
    assert (valueMatch(x0.getValue(CPos("I16")), CValue("brrr")));
    assert (valueMatch(x0.getValue(CPos("I17")), CValue(-5.0)));
    assert (valueMatch(x0.getValue(CPos("I18")), CValue(-5.0)));
    assert (valueMatch(x0.getValue(CPos("I19")), CValue(1.0)));
    assert (valueMatch(x0.getValue(CPos("I20")), CValue(1.0)));
    assert (valueMatch(x0.getValue(CPos("I21")), CValue("\n jaj \n \n")));
    assert (valueMatch(x0.getValue(CPos("I22")), CValue(3.0)));
    assert (valueMatch(x0.getValue(CPos("I23")), CValue(1.0)));
    assert (valueMatch(x0.getValue(CPos("I24")), CValue(1.0)));
    assert (valueMatch(x0.getValue(CPos("I25")), CValue(3.0)));
    assert (valueMatch(x0.getValue(CPos("I26")), CValue(1.0)));
    assert (valueMatch(x0.getValue(CPos("I27")), CValue(1.0)));

    assert (valueMatch(x0.getValue(CPos("J9")), CValue(11.0)));
    assert (valueMatch(x0.getValue(CPos("J10")), CValue(1e+12)));
    assert (valueMatch(x0.getValue(CPos("J11")), CValue(1e+100)));
    assert (valueMatch(x0.getValue(CPos("J12")), CValue()));
    assert (valueMatch(x0.getValue(CPos("J13")), CValue(4.0)));
    assert (valueMatch(x0.getValue(CPos("J14")), CValue(3.0)));
    assert (valueMatch(x0.getValue(CPos("J15")), CValue(630.0)));
    assert (valueMatch(x0.getValue(CPos("J16")), CValue()));
    assert (valueMatch(x0.getValue(CPos("J17")), CValue()));
    assert (valueMatch(x0.getValue(CPos("J18")), CValue()));
    assert (valueMatch(x0.getValue(CPos("J19")), CValue(8.0)));
    assert (valueMatch(x0.getValue(CPos("J20")), CValue(8.0)));
    assert (valueMatch(x0.getValue(CPos("J21")), CValue(8.0)));
    assert (valueMatch(x0.getValue(CPos("J22")), CValue(8.0)));
    assert (valueMatch(x0.getValue(CPos("J23")), CValue(8.0)));
    assert (valueMatch(x0.getValue(CPos("J24")), CValue(8.0)));
    assert (valueMatch(x0.getValue(CPos("J25")), CValue(90.0)));


    assert (valueMatch(x0.getValue(CPos("K11")), CValue(100.0)));
    assert (valueMatch(x0.getValue(CPos("K12")), CValue(0.0)));
    assert (valueMatch(x0.getValue(CPos("K13")), CValue(1.0)));
    assert (valueMatch(x0.getValue(CPos("K14")), CValue(2.0)));
    assert (valueMatch(x0.getValue(CPos("K15")), CValue(3.0)));
    assert (valueMatch(x0.getValue(CPos("K16")), CValue(4.0)));
    assert (valueMatch(x0.getValue(CPos("K17")), CValue(5.0)));
    assert (valueMatch(x0.getValue(CPos("K18")), CValue(6.0)));
    assert (valueMatch(x0.getValue(CPos("K19")), CValue("brrr")));
    assert (valueMatch(x0.getValue(CPos("K20")), CValue(241.0)));
    assert (valueMatch(x0.getValue(CPos("K21")), CValue(438.0)));
    assert (valueMatch(x0.getValue(CPos("K22")), CValue(239.0)));
    assert (valueMatch(x0.getValue(CPos("K23")), CValue(280.0)));
    assert (valueMatch(x0.getValue(CPos("K24")), CValue(455.0)));

    assert (valueMatch(x0.getValue(CPos("L10")), CValue(12.0)));
    assert (valueMatch(x0.getValue(CPos("L11")), CValue(14.0)));
    assert (valueMatch(x0.getValue(CPos("L12")), CValue(45.0)));
    assert (valueMatch(x0.getValue(CPos("L13")), CValue(20.0)));
    assert (valueMatch(x0.getValue(CPos("L14")), CValue(0.125)));
    assert (valueMatch(x0.getValue(CPos("L15")), CValue(0.125)));
    assert (valueMatch(x0.getValue(CPos("L16")), CValue(0.125)));
    assert (valueMatch(x0.getValue(CPos("L17")), CValue(-10.0)));
    assert (valueMatch(x0.getValue(CPos("L18")), CValue(-454.0)));
    assert (valueMatch(x0.getValue(CPos("L19")), CValue(-203.0)));
    assert (valueMatch(x0.getValue(CPos("L20")), CValue(205.0)));
    assert (valueMatch(x0.getValue(CPos("L21")), CValue(206.0)));
    assert (valueMatch(x0.getValue(CPos("L22")), CValue(207.0)));
    assert (valueMatch(x0.getValue(CPos("L23")), CValue(209.0)));
    assert (valueMatch(x0.getValue(CPos("L24")), CValue(456.0)));

    assert (valueMatch(x0.getValue(CPos("M13")), CValue(18.0)));
    assert (valueMatch(x0.getValue(CPos("M14")), CValue("\n jaj \n \n\n jaj \n \n")));
    assert (valueMatch(x0.getValue(CPos("M18")), CValue(-454.0)));
    assert (valueMatch(x0.getValue(CPos("M19")), CValue(-203.0)));
    assert (valueMatch(x0.getValue(CPos("M20")), CValue(202.0)));
    assert (valueMatch(x0.getValue(CPos("M22")), CValue("\n jaj \n \n")));

    //========================================================================================
    oss.clear();
    oss.str("");
    assert (x0.save(oss));
    data = oss.str();
    iss.clear();
    iss.str(data);
    CSpreadsheet x2;
    assert (x2.load(iss));

    x2.copyRect(CPos("L9"), CPos("L9"), 1, 17);
    assert (valueMatch(x2.getValue(CPos("L9")), CValue()));
    assert (valueMatch(x2.getValue(CPos("L25")), CValue()));
    assert (valueMatch(x2.getValue(CPos("L10")), CValue(12.0)));
    assert (valueMatch(x2.getValue(CPos("L11")), CValue(14.0)));
    assert (valueMatch(x2.getValue(CPos("L12")), CValue(45.0)));
    assert (valueMatch(x2.getValue(CPos("L13")), CValue(20.0)));
    assert (valueMatch(x2.getValue(CPos("L14")), CValue(0.125)));
    assert (valueMatch(x2.getValue(CPos("L15")), CValue(0.125)));
    assert (valueMatch(x2.getValue(CPos("L16")), CValue(0.125)));
    assert (valueMatch(x2.getValue(CPos("L17")), CValue(-10.0)));
    assert (valueMatch(x2.getValue(CPos("L18")), CValue(-454.0)));
    assert (valueMatch(x2.getValue(CPos("L19")), CValue(-203.0)));
    assert (valueMatch(x2.getValue(CPos("L20")), CValue(205.0)));
    assert (valueMatch(x2.getValue(CPos("L21")), CValue(206.0)));
    assert (valueMatch(x2.getValue(CPos("L22")), CValue(207.0)));
    assert (valueMatch(x2.getValue(CPos("L23")), CValue(209.0)));
    assert (valueMatch(x2.getValue(CPos("L24")), CValue(456.0)));

    x2.copyRect(CPos("A2"), CPos("A1"), 20, 1);
    for (int i = 1; i <= 20; ++i) {
        assert (valueMatch(x2.getValue(CPos(i, 1)), CValue()));
        assert (valueMatch(x2.getValue(CPos(i, 2)), CValue()));
    }

    oss.clear();
    oss.str("");
    assert (x2.save(oss));
    data = oss.str();
    iss.clear();
    iss.str(data);
    assert (x1.load(iss));

    x1.setCell(CPos("M16"), "=$L$15 +$J21 - F$15");
    assert (valueMatch(x1.getValue(CPos("M16")), CValue(-191.875)));
    x1.copyRect(CPos("G11"), CPos("J14"), 5, 5);

    assert (valueMatch(x1.getValue(CPos("G11")), CValue(3.0)));
    assert (valueMatch(x1.getValue(CPos("G12")), CValue()));
    assert (valueMatch(x1.getValue(CPos("G13")), CValue()));
    assert (valueMatch(x1.getValue(CPos("G14")), CValue()));
    assert (valueMatch(x1.getValue(CPos("G15")), CValue(630.0)));

    assert (valueMatch(x1.getValue(CPos("H11")), CValue(2.0)));
    assert (valueMatch(x1.getValue(CPos("H12")), CValue(3.0)));
    assert (valueMatch(x1.getValue(CPos("H13")), CValue(4.0)));
    assert (valueMatch(x1.getValue(CPos("H14")), CValue(5.0)));
    assert (valueMatch(x1.getValue(CPos("H15")), CValue(6.0)));

    assert (valueMatch(x1.getValue(CPos("I11")), CValue(0.125)));
    assert (valueMatch(x1.getValue(CPos("I12")), CValue(0.125)));
    assert (valueMatch(x1.getValue(CPos("I13")), CValue(0.125)));
    assert (valueMatch(x1.getValue(CPos("I14")), CValue()));
    assert (valueMatch(x1.getValue(CPos("I15")), CValue()));

    assert (valueMatch(x1.getValue(CPos("J11")), CValue(8.0)));
    assert (valueMatch(x1.getValue(CPos("J12")), CValue()));
    assert (valueMatch(x1.getValue(CPos("J13")), CValue()));
    assert (valueMatch(x1.getValue(CPos("J14")), CValue()));
    assert (valueMatch(x1.getValue(CPos("J15")), CValue()));//12-(50+brrrbrrr)

    assert (valueMatch(x1.getValue(CPos("K11")), CValue()));
    assert (valueMatch(x1.getValue(CPos("K12")), CValue()));
    assert (valueMatch(x1.getValue(CPos("K13")), CValue()));
    assert (valueMatch(x1.getValue(CPos("K14")), CValue()));
    assert (valueMatch(x1.getValue(CPos("K15")), CValue()));
//    assert (x0.setCell(CPos(""), ""));
//    assert (valueMatch(x0.getValue(CPos("")), CValue()));



    oss.clear();
    oss.str("");
    assert (x1.save(oss));
    data = oss.str();
    iss.clear();
    iss.str(data);
    assert (x0.load(iss));

    assert (x0.setCell(CPos("I14"), "15"));
    assert (x0.setCell(CPos("J14"), "2"));
    assert (x0.setCell(CPos("K14"), "3"));
    assert (x0.setCell(CPos("K15"), "=J25"));
    assert (x0.setCell(CPos("M14"), "=K23"));
    assert (x0.setCell(CPos("H9"), "=L21"));
    assert (x0.setCell(CPos("I16"), "=H21"));
    assert (x0.setCell(CPos("M21"), "=G25"));
    assert (x0.setCell(CPos("I21"), "=K16"));
    assert (x0.setCell(CPos("F13"), "=F15"));
    assert (x0.setCell(CPos("K19"), "=H19"));
    assert (x0.setCell(CPos("H10"), "79"));
    assert (x0.setCell(CPos("H18"), "=G23"));
    assert (x0.setCell(CPos("J13"), "=$L$15 +$J18"));
    assert (x0.setCell(CPos("M10"), "=L13"));
    assert (x0.setCell(CPos("M11"), "=M20"));
    assert (x0.setCell(CPos("M12"), "=G18"));

    x0.copyRect(CPos("K20"), CPos("J20"), 3, 5);

    oss.clear();
    oss.str("");
    assert (x0.save(oss));
    data = oss.str();
    iss.clear();
    iss.str(data);
    assert (x2.load(iss));
    //-------------------------------------------------------------------------------------
    assert (valueMatch(x2.getValue(CPos("F8")), CValue(50.0)));
    assert (valueMatch(x2.getValue(CPos("F9")), CValue(10.0)));
    assert (valueMatch(x2.getValue(CPos("F10")), CValue(10.0)));
    assert (valueMatch(x2.getValue(CPos("F11")), CValue(10.0)));
    assert (valueMatch(x2.getValue(CPos("F12")), CValue(10.0)));
    assert (valueMatch(x2.getValue(CPos("F13")), CValue(200.0)));
    assert (valueMatch(x2.getValue(CPos("F14")), CValue(4.0)));
    assert (valueMatch(x2.getValue(CPos("F15")), CValue(200.0)));
    assert (valueMatch(x2.getValue(CPos("F16")), CValue(0.0)));
    assert (valueMatch(x2.getValue(CPos("F17")), CValue(40.0)));
    assert (valueMatch(x2.getValue(CPos("F18")), CValue(0.0)));
    assert (valueMatch(x2.getValue(CPos("F19")), CValue(0.0)));
    assert (valueMatch(x2.getValue(CPos("F20")), CValue(0.0)));
    assert (valueMatch(x2.getValue(CPos("F21")), CValue(-190.0)));
    assert (valueMatch(x2.getValue(CPos("F22")), CValue(196.0)));
    assert (valueMatch(x2.getValue(CPos("F23")), CValue(-196.0)));
    assert (valueMatch(x2.getValue(CPos("F24")), CValue(200.0)));
    assert (valueMatch(x2.getValue(CPos("F25")), CValue(-40.0)));
    assert (valueMatch(x2.getValue(CPos("F26")), CValue(40.0)));

    assert (valueMatch(x2.getValue(CPos("G9")), CValue(310.0)));
    assert (valueMatch(x2.getValue(CPos("G10")), CValue(1e+12)));
    assert (valueMatch(x2.getValue(CPos("G11")), CValue(3.0)));
    assert (valueMatch(x2.getValue(CPos("G12")), CValue(12600.0)));
    assert (valueMatch(x2.getValue(CPos("G13")), CValue(-1736.0)));
    assert (valueMatch(x2.getValue(CPos("G14")), CValue(9065.0)));
    assert (valueMatch(x2.getValue(CPos("G15")), CValue(630.0)));
    assert (valueMatch(x2.getValue(CPos("G16")), CValue(-31.0)));
    assert (valueMatch(x2.getValue(CPos("G17")), CValue(259.0)));
    assert (valueMatch(x2.getValue(CPos("G18")), CValue(35.0)));
    assert (valueMatch(x2.getValue(CPos("G19")), CValue(-5.0)));
    assert (valueMatch(x2.getValue(CPos("G20")), CValue(1.0)));
    assert (valueMatch(x2.getValue(CPos("G21")), CValue(1.0)));
    assert (valueMatch(x2.getValue(CPos("G22")), CValue(-186.0)));
    assert (valueMatch(x2.getValue(CPos("G23")), CValue(199.0)));
    assert (valueMatch(x2.getValue(CPos("G24")), CValue(-195.0)));
    assert (valueMatch(x2.getValue(CPos("G25")), CValue(201.0)));
    assert (valueMatch(x2.getValue(CPos("G26")), CValue(-37.0)));
    assert (valueMatch(x2.getValue(CPos("G27")), CValue(450.0)));

    assert (valueMatch(x2.getValue(CPos("H9")), CValue(504.0)));
    assert (valueMatch(x2.getValue(CPos("H10")), CValue(79.0)));
    assert (valueMatch(x2.getValue(CPos("H11")), CValue(2.0)));
    assert (valueMatch(x2.getValue(CPos("H12")), CValue(3.0)));
    assert (valueMatch(x2.getValue(CPos("H13")), CValue(4.0)));
    assert (valueMatch(x2.getValue(CPos("H14")), CValue(5.0)));
    assert (valueMatch(x2.getValue(CPos("H15")), CValue(6.0)));
    assert (valueMatch(x2.getValue(CPos("H16")), CValue(-5e+12)));
    assert (valueMatch(x2.getValue(CPos("H17")), CValue(2.0)));
    assert (valueMatch(x2.getValue(CPos("H18")), CValue(199.0)));
    assert (valueMatch(x2.getValue(CPos("H19")), CValue(1.0)));
    assert (valueMatch(x2.getValue(CPos("H20")), CValue(0.0)));
    assert (valueMatch(x2.getValue(CPos("H21")), CValue(259.0)));
    assert (valueMatch(x2.getValue(CPos("H22")), CValue(10.0)));
    assert (valueMatch(x2.getValue(CPos("H23")), CValue(60.0)));

    assert (valueMatch(x2.getValue(CPos("I8")), CValue(260.0)));
    assert (valueMatch(x2.getValue(CPos("I9")), CValue(1e+12)));
    assert (valueMatch(x2.getValue(CPos("I10")), CValue(12.0)));
    assert (valueMatch(x2.getValue(CPos("I11")), CValue(0.125)));
    assert (valueMatch(x2.getValue(CPos("I12")), CValue(0.125)));
    assert (valueMatch(x2.getValue(CPos("I13")), CValue(0.125)));
    assert (valueMatch(x2.getValue(CPos("I14")), CValue(15.0)));
    assert (valueMatch(x2.getValue(CPos("I15")), CValue(-231.0)));
    assert (valueMatch(x2.getValue(CPos("I16")), CValue(259.0)));
    assert (valueMatch(x2.getValue(CPos("I17")), CValue(-5.0)));
    assert (valueMatch(x2.getValue(CPos("I18")), CValue(-5.0)));
    assert (valueMatch(x2.getValue(CPos("I19")), CValue(1.0)));
    assert (valueMatch(x2.getValue(CPos("I20")), CValue(1.0)));
    assert (valueMatch(x2.getValue(CPos("I21")), CValue(4.0)));
    assert (valueMatch(x2.getValue(CPos("I22")), CValue(3.0)));
    assert (valueMatch(x2.getValue(CPos("I23")), CValue(1.0)));
    assert (valueMatch(x2.getValue(CPos("I24")), CValue(1.0)));
    assert (valueMatch(x2.getValue(CPos("I25")), CValue(3.0)));
    assert (valueMatch(x2.getValue(CPos("I26")), CValue(1.0)));
    assert (valueMatch(x2.getValue(CPos("I27")), CValue(1.0)));

    assert (valueMatch(x2.getValue(CPos("J9")), CValue(11.0)));
    assert (valueMatch(x2.getValue(CPos("J10")), CValue(1e+12)));
    assert (valueMatch(x2.getValue(CPos("J11")), CValue(8.0)));
    assert (valueMatch(x2.getValue(CPos("J12")), CValue()));
    assert (valueMatch(x2.getValue(CPos("J13")), CValue(-191.75)));
    assert (valueMatch(x2.getValue(CPos("J14")), CValue(2.0)));
    assert (valueMatch(x2.getValue(CPos("J15")), CValue(-298.0)));
    assert (valueMatch(x2.getValue(CPos("J16")), CValue(-5e+12)));
    assert (valueMatch(x2.getValue(CPos("J17")), CValue()));
    assert (valueMatch(x2.getValue(CPos("J18")), CValue(-191.875)));
    assert (valueMatch(x2.getValue(CPos("J19")), CValue(8.0)));
    assert (valueMatch(x2.getValue(CPos("J20")), CValue(8.0)));
    assert (valueMatch(x2.getValue(CPos("J21")), CValue(8.0)));
    assert (valueMatch(x2.getValue(CPos("J22")), CValue(8.0)));
    assert (valueMatch(x2.getValue(CPos("J23")), CValue(8.0)));
    assert (valueMatch(x2.getValue(CPos("J24")), CValue(8.0)));
    assert (valueMatch(x2.getValue(CPos("J25")), CValue(90.0)));

    assert (valueMatch(x2.getValue(CPos("K6")), CValue(0.0)));
    assert (valueMatch(x2.getValue(CPos("K10")), CValue(12.0)));
    assert (valueMatch(x2.getValue(CPos("K11")), CValue()));
    assert (valueMatch(x2.getValue(CPos("K12")), CValue()));
    assert (valueMatch(x2.getValue(CPos("K13")), CValue()));
    assert (valueMatch(x2.getValue(CPos("K14")), CValue(3.0)));
    assert (valueMatch(x2.getValue(CPos("K15")), CValue(90.0)));
    assert (valueMatch(x2.getValue(CPos("K16")), CValue(4.0)));
    assert (valueMatch(x2.getValue(CPos("K17")), CValue(5.0)));
    assert (valueMatch(x2.getValue(CPos("K18")), CValue(6.0)));
    assert (valueMatch(x2.getValue(CPos("K19")), CValue(1.0)));
    assert (valueMatch(x2.getValue(CPos("K20")), CValue(1e+12)));
    assert (valueMatch(x2.getValue(CPos("K21")), CValue(1e+12)));
    assert (valueMatch(x2.getValue(CPos("K22")), CValue(1e+12)));
    assert (valueMatch(x2.getValue(CPos("K23")), CValue(1e+12)));
    assert (valueMatch(x2.getValue(CPos("K24")), CValue(1e+12)));

    assert (valueMatch(x2.getValue(CPos("L10")), CValue(12.0)));
    assert (valueMatch(x2.getValue(CPos("L11")), CValue(14.0)));
    assert (valueMatch(x2.getValue(CPos("L12")), CValue(45.0)));
    assert (valueMatch(x2.getValue(CPos("L13")), CValue(20.0)));
    assert (valueMatch(x2.getValue(CPos("L14")), CValue(0.125)));
    assert (valueMatch(x2.getValue(CPos("L15")), CValue(0.125)));
    assert (valueMatch(x2.getValue(CPos("L16")), CValue(0.125)));
    assert (valueMatch(x2.getValue(CPos("L17")), CValue(9.0)));
    assert (valueMatch(x2.getValue(CPos("L18")), CValue(-12588.0)));
    assert (valueMatch(x2.getValue(CPos("L19")), CValue(1748.0)));
    assert (valueMatch(x2.getValue(CPos("L20")), CValue(221.0)));
    assert (valueMatch(x2.getValue(CPos("L21")), CValue(504.0)));
    assert (valueMatch(x2.getValue(CPos("L22")), CValue(218.0)));
    assert (valueMatch(x2.getValue(CPos("L23")), CValue(259.0)));
    assert (valueMatch(x2.getValue(CPos("L24")), CValue(455.0)));

    assert (valueMatch(x2.getValue(CPos("M10")), CValue(20.0)));
    assert (valueMatch(x2.getValue(CPos("M11")), CValue(56.0)));
    assert (valueMatch(x2.getValue(CPos("M12")), CValue(35.0)));
    assert (valueMatch(x2.getValue(CPos("M13")), CValue(18.0)));
    assert (valueMatch(x2.getValue(CPos("M14")), CValue(1e+12)));
    assert (valueMatch(x2.getValue(CPos("M16")), CValue(-191.875)));
    assert (valueMatch(x2.getValue(CPos("M18")), CValue(-12588.0)));
    assert (valueMatch(x2.getValue(CPos("M19")), CValue(1748.0)));
    assert (valueMatch(x2.getValue(CPos("M20")), CValue(56.0)));
    assert (valueMatch(x2.getValue(CPos("M21")), CValue(143.0)));
    assert (valueMatch(x2.getValue(CPos("M22")), CValue(57.0)));
    assert (valueMatch(x2.getValue(CPos("M23")), CValue(9120.0)));
    assert (valueMatch(x2.getValue(CPos("M24")), CValue(456.0)));

    x2.copyRect(CPos("G20"), CPos("F22"), 8, 2);

    oss.clear();
    oss.str("");
    assert (x2.save(oss));
    data = oss.str();
    iss.clear();
    iss.str(data);
    assert (x1.load(iss));

    assert (valueMatch(x1.getValue(CPos("F8")), CValue(50.0)));
    assert (valueMatch(x1.getValue(CPos("F9")), CValue(10.0)));
    assert (valueMatch(x1.getValue(CPos("F10")), CValue(10.0)));
    assert (valueMatch(x1.getValue(CPos("F11")), CValue(10.0)));
    assert (valueMatch(x1.getValue(CPos("F12")), CValue(10.0)));
    assert (valueMatch(x1.getValue(CPos("F13")), CValue(200.0)));
    assert (valueMatch(x1.getValue(CPos("F14")), CValue(4.0)));
    assert (valueMatch(x1.getValue(CPos("F15")), CValue(200.0)));
    assert (valueMatch(x1.getValue(CPos("F16")), CValue(0.0)));
    assert (valueMatch(x1.getValue(CPos("F17")), CValue(40.0)));
    assert (valueMatch(x1.getValue(CPos("F18")), CValue(0.0)));
    assert (valueMatch(x1.getValue(CPos("F19")), CValue(0.0)));
    assert (valueMatch(x1.getValue(CPos("F20")), CValue(0.0)));
    assert (valueMatch(x1.getValue(CPos("F21")), CValue(-190.0)));
    assert (valueMatch(x1.getValue(CPos("F22")), CValue(196.0)));
    assert (valueMatch(x1.getValue(CPos("F23")), CValue(-196.0)));
    assert (valueMatch(x1.getValue(CPos("F24")), CValue(200.0)));
    assert (valueMatch(x1.getValue(CPos("F25")), CValue(-40.0)));
    assert (valueMatch(x1.getValue(CPos("F26")), CValue(40.0)));

    assert (valueMatch(x1.getValue(CPos("G9")), CValue(-12543.0)));
    assert (valueMatch(x1.getValue(CPos("G10")), CValue(10.0 - 5.0 + (1e+12) - (-440790.0))));
    assert (valueMatch(x1.getValue(CPos("G11")), CValue(3.0)));
    assert (valueMatch(x1.getValue(CPos("G12")), CValue(12600.0)));
    assert (valueMatch(x1.getValue(CPos("G13")), CValue(217974.0)));
    assert (valueMatch(x1.getValue(CPos("G14")), CValue(-440790.0)));
    assert (valueMatch(x1.getValue(CPos("G15")), CValue(630.0)));
    assert (valueMatch(x1.getValue(CPos("G16")), CValue(12822.0)));
    assert (valueMatch(x1.getValue(CPos("G17")), CValue(-12594.0)));
    assert (valueMatch(x1.getValue(CPos("G18")), CValue(35.0)));
    assert (valueMatch(x1.getValue(CPos("G19")), CValue(-5.0)));
    assert (valueMatch(x1.getValue(CPos("G20")), CValue(-12597.0)));
    assert (valueMatch(x1.getValue(CPos("G21")), CValue(-205374.0)));
    assert (valueMatch(x1.getValue(CPos("G22")), CValue(-130.0)));
    assert (valueMatch(x1.getValue(CPos("G23")), CValue(199.0)));
    assert (valueMatch(x1.getValue(CPos("G24")), CValue(-195.0)));
    assert (valueMatch(x1.getValue(CPos("G25")), CValue(201.0)));
    assert (valueMatch(x1.getValue(CPos("G26")), CValue(-37.0)));
    assert (valueMatch(x1.getValue(CPos("G27")), CValue(450.0)));

    assert (valueMatch(x1.getValue(CPos("H9")), CValue(7.0)));
    assert (valueMatch(x1.getValue(CPos("H10")), CValue(79.0)));
    assert (valueMatch(x1.getValue(CPos("H11")), CValue(2.0)));
    assert (valueMatch(x1.getValue(CPos("H12")), CValue(3.0)));
    assert (valueMatch(x1.getValue(CPos("H13")), CValue(4.0)));
    assert (valueMatch(x1.getValue(CPos("H14")), CValue(5.0)));
    assert (valueMatch(x1.getValue(CPos("H15")), CValue(6.0)));
    assert (valueMatch(x1.getValue(CPos("H16")), CValue(-5.0 * (1e+12 + 440790.0))));
    assert (valueMatch(x1.getValue(CPos("H17")), CValue(2.0)));
    assert (valueMatch(x1.getValue(CPos("H18")), CValue(199.0)));
    assert (valueMatch(x1.getValue(CPos("H19")), CValue(1.0)));
    assert (valueMatch(x1.getValue(CPos("H20")), CValue(3.0)));
    assert (valueMatch(x1.getValue(CPos("H21")), CValue(-12594.0)));
    assert (valueMatch(x1.getValue(CPos("H22")), CValue(10.0)));
    assert (valueMatch(x1.getValue(CPos("H23")), CValue(60.0)));

    assert (valueMatch(x1.getValue(CPos("I8")), CValue(-12593.0)));
    assert (valueMatch(x1.getValue(CPos("I9")), CValue(1000000440785.0)));
    assert (valueMatch(x1.getValue(CPos("I10")), CValue(12.0)));
    assert (valueMatch(x1.getValue(CPos("I11")), CValue(0.125)));
    assert (valueMatch(x1.getValue(CPos("I12")), CValue(0.125)));
    assert (valueMatch(x1.getValue(CPos("I13")), CValue(0.125)));
    assert (valueMatch(x1.getValue(CPos("I14")), CValue(15.0)));
    assert (valueMatch(x1.getValue(CPos("I15")), CValue(12622.0)));
    assert (valueMatch(x1.getValue(CPos("I16")), CValue(-12594.0)));
    assert (valueMatch(x1.getValue(CPos("I17")), CValue(-5.0)));
    assert (valueMatch(x1.getValue(CPos("I18")), CValue(-5.0)));
    assert (valueMatch(x1.getValue(CPos("I19")), CValue(1.0)));
    assert (valueMatch(x1.getValue(CPos("I20")), CValue(10.0)));
    assert (valueMatch(x1.getValue(CPos("I21")), CValue(60.0)));
    assert (valueMatch(x1.getValue(CPos("I22")), CValue(3.0)));
    assert (valueMatch(x1.getValue(CPos("I23")), CValue(1.0)));
    assert (valueMatch(x1.getValue(CPos("I24")), CValue(1.0)));
    assert (valueMatch(x1.getValue(CPos("I25")), CValue(3.0)));
    assert (valueMatch(x1.getValue(CPos("I26")), CValue(1.0)));
    assert (valueMatch(x1.getValue(CPos("I27")), CValue(1.0)));

    assert (valueMatch(x1.getValue(CPos("J9")), CValue(11.0)));
    assert (valueMatch(x1.getValue(CPos("J10")), CValue(1e+12)));
    assert (valueMatch(x1.getValue(CPos("J11")), CValue(8.0)));
    assert (valueMatch(x1.getValue(CPos("J12")), CValue()));
    assert (valueMatch(x1.getValue(CPos("J13")), CValue(40843754.38)));
    assert (valueMatch(x1.getValue(CPos("J14")), CValue(2.0)));
    assert (valueMatch(x1.getValue(CPos("J15")), CValue(12555.0)));
    assert (valueMatch(x1.getValue(CPos("J16")), CValue(-5000002203950.0)));
    assert (valueMatch(x1.getValue(CPos("J17")), CValue()));
    assert (valueMatch(x1.getValue(CPos("J18")), CValue(40843754.25)));
    assert (valueMatch(x1.getValue(CPos("J19")), CValue(8.0)));
    assert (valueMatch(x1.getValue(CPos("J20")), CValue(3.0)));
    assert (valueMatch(x1.getValue(CPos("J21")), CValue(1.0)));
    assert (valueMatch(x1.getValue(CPos("J22")), CValue(8.0)));
    assert (valueMatch(x1.getValue(CPos("J23")), CValue(8.0)));
    assert (valueMatch(x1.getValue(CPos("J24")), CValue(8.0)));
    assert (valueMatch(x1.getValue(CPos("J25")), CValue(90.0)));

    assert (valueMatch(x1.getValue(CPos("K6")), CValue(0.0)));
    assert (valueMatch(x1.getValue(CPos("K10")), CValue(12.0)));
    assert (valueMatch(x1.getValue(CPos("K11")), CValue()));
    assert (valueMatch(x1.getValue(CPos("K12")), CValue()));
    assert (valueMatch(x1.getValue(CPos("K13")), CValue()));
    assert (valueMatch(x1.getValue(CPos("K14")), CValue(3.0)));
    assert (valueMatch(x1.getValue(CPos("K15")), CValue(90.0)));
    assert (valueMatch(x1.getValue(CPos("K16")), CValue(4.0)));
    assert (valueMatch(x1.getValue(CPos("K17")), CValue(5.0)));
    assert (valueMatch(x1.getValue(CPos("K18")), CValue(6.0)));
    assert (valueMatch(x1.getValue(CPos("K19")), CValue(1.0)));
    assert (valueMatch(x1.getValue(CPos("K20")), CValue(1000000440790.0)));
    assert (valueMatch(x1.getValue(CPos("K21")), CValue(1000000440790.0)));
    assert (valueMatch(x1.getValue(CPos("K22")), CValue(1000000440790.0)));
    assert (valueMatch(x1.getValue(CPos("K23")), CValue(1000000440790.0)));
    assert (valueMatch(x1.getValue(CPos("K24")), CValue(1000000440790.0)));

    assert (valueMatch(x1.getValue(CPos("L10")), CValue(12.0)));
    assert (valueMatch(x1.getValue(CPos("L11")), CValue(14.0)));
    assert (valueMatch(x1.getValue(CPos("L12")), CValue(45.0)));
    assert (valueMatch(x1.getValue(CPos("L13")), CValue(20.0)));
    assert (valueMatch(x1.getValue(CPos("L14")), CValue(0.125)));
    assert (valueMatch(x1.getValue(CPos("L15")), CValue(0.125)));
    assert (valueMatch(x1.getValue(CPos("L16")), CValue(0.125)));
    assert (valueMatch(x1.getValue(CPos("L17")), CValue(9.0)));
    assert (valueMatch(x1.getValue(CPos("L18")), CValue(-12588.0)));
    assert (valueMatch(x1.getValue(CPos("L19")), CValue(-217962.0)));
    assert (valueMatch(x1.getValue(CPos("L20")), CValue(7.0)));
    assert (valueMatch(x1.getValue(CPos("L21")), CValue(7.0)));
    assert (valueMatch(x1.getValue(CPos("L22")), CValue(218.0)));
    assert (valueMatch(x1.getValue(CPos("L23")), CValue(259.0)));
    assert (valueMatch(x1.getValue(CPos("L24")), CValue(455.0)));

    assert (valueMatch(x1.getValue(CPos("M10")), CValue(20.0)));
    assert (valueMatch(x1.getValue(CPos("M11")), CValue(17.0)));
    assert (valueMatch(x1.getValue(CPos("M12")), CValue(35.0)));
    assert (valueMatch(x1.getValue(CPos("M13")), CValue(18.0)));
    assert (valueMatch(x1.getValue(CPos("M14")), CValue(1000000440790.0)));
    assert (valueMatch(x1.getValue(CPos("M16")), CValue(-198.875)));
    assert (valueMatch(x1.getValue(CPos("M18")), CValue(-12588.0)));
    assert (valueMatch(x1.getValue(CPos("M19")), CValue(-217962.0)));
    assert (valueMatch(x1.getValue(CPos("M20")), CValue(17.0)));
    assert (valueMatch(x1.getValue(CPos("M21")), CValue(300.0)));
    assert (valueMatch(x1.getValue(CPos("M22")), CValue(57.0)));
    assert (valueMatch(x1.getValue(CPos("M23")), CValue(-440735.0)));
    assert (valueMatch(x1.getValue(CPos("M24")), CValue(456.0)));

    assert (valueMatch(x1.getValue(CPos("N20")), CValue(217.125)));
    assert (valueMatch(x1.getValue(CPos("N21")), CValue(309.0)));

    x1.copyRect(CPos("F16"), CPos("K10"), 3, 7);

    oss.clear();
    oss.str("");
    assert (x1.save(oss));
    data = oss.str();
    iss.clear();
    iss.str(data);
    assert (x0.load(iss));

    //-------------------------------------------------------------------------------------
    assert (valueMatch(x0.getValue(CPos("F8")), CValue(50.0)));
    assert (valueMatch(x0.getValue(CPos("F9")), CValue(10.0)));
    assert (valueMatch(x0.getValue(CPos("F10")), CValue(10.0)));
    assert (valueMatch(x0.getValue(CPos("F11")), CValue(10.0)));
    assert (valueMatch(x0.getValue(CPos("F12")), CValue(10.0)));
    assert (valueMatch(x0.getValue(CPos("F13")), CValue(200.0)));
    assert (valueMatch(x0.getValue(CPos("F14")), CValue(4.0)));
    assert (valueMatch(x0.getValue(CPos("F15")), CValue(200.0)));
    assert (valueMatch(x0.getValue(CPos("F16")), CValue(12.0)));
    assert (valueMatch(x0.getValue(CPos("F17")), CValue()));
    assert (valueMatch(x0.getValue(CPos("F18")), CValue()));
    assert (valueMatch(x0.getValue(CPos("F19")), CValue()));
    assert (valueMatch(x0.getValue(CPos("F20")), CValue(3.0)));
    assert (valueMatch(x0.getValue(CPos("F21")), CValue()));
    assert (valueMatch(x0.getValue(CPos("F22")), CValue(4.0)));
    assert (valueMatch(x0.getValue(CPos("F23")), CValue(-196.0)));
    assert (valueMatch(x0.getValue(CPos("F24")), CValue(188.0)));
    assert (valueMatch(x0.getValue(CPos("F25")), CValue()));
    assert (valueMatch(x0.getValue(CPos("F26")), CValue()));

    assert (valueMatch(x0.getValue(CPos("G9")), CValue()));
    assert (valueMatch(x0.getValue(CPos("G10")), CValue(999999999375.0)));
    assert (valueMatch(x0.getValue(CPos("G11")), CValue(3.0)));
    assert (valueMatch(x0.getValue(CPos("G12")), CValue(16200.0)));
    assert (valueMatch(x0.getValue(CPos("G13")), CValue(204.0)));
    assert (valueMatch(x0.getValue(CPos("G14")), CValue(630.0)));
    assert (valueMatch(x0.getValue(CPos("G15")), CValue(810.0)));
    assert (valueMatch(x0.getValue(CPos("G16")), CValue(12.0)));
    assert (valueMatch(x0.getValue(CPos("G17")), CValue(14.0)));
    assert (valueMatch(x0.getValue(CPos("G18")), CValue(45.0)));
    assert (valueMatch(x0.getValue(CPos("G19")), CValue(20.0)));
    assert (valueMatch(x0.getValue(CPos("G20")), CValue(0.125)));
    assert (valueMatch(x0.getValue(CPos("G21")), CValue(0.125)));
    assert (valueMatch(x0.getValue(CPos("G22")), CValue(0.125)));
    assert (valueMatch(x0.getValue(CPos("G23")), CValue(7.0)));
    assert (valueMatch(x0.getValue(CPos("G24")), CValue(-195.0)));
    assert (valueMatch(x0.getValue(CPos("G25")), CValue(189.0)));
    assert (valueMatch(x0.getValue(CPos("G26")), CValue()));
    assert (valueMatch(x0.getValue(CPos("G27")), CValue(450.0)));

    assert (valueMatch(x0.getValue(CPos("H9")), CValue(7.0)));
    assert (valueMatch(x0.getValue(CPos("H10")), CValue(79.0)));
    assert (valueMatch(x0.getValue(CPos("H11")), CValue(2.0)));
    assert (valueMatch(x0.getValue(CPos("H12")), CValue(3.0)));
    assert (valueMatch(x0.getValue(CPos("H13")), CValue(4.0)));
    assert (valueMatch(x0.getValue(CPos("H14")), CValue(5.0)));
    assert (valueMatch(x0.getValue(CPos("H15")), CValue(6.0)));
    assert (valueMatch(x0.getValue(CPos("H16")), CValue(20.0)));
    assert (valueMatch(x0.getValue(CPos("H17")), CValue()));
    assert (valueMatch(x0.getValue(CPos("H18")), CValue()));
    assert (valueMatch(x0.getValue(CPos("H19")), CValue(18.0)));
    assert (valueMatch(x0.getValue(CPos("H20")), CValue()));
    assert (valueMatch(x0.getValue(CPos("H21")), CValue()));
    assert (valueMatch(x0.getValue(CPos("H22")), CValue()));
    assert (valueMatch(x0.getValue(CPos("H23")), CValue(60.0)));

    assert (valueMatch(x0.getValue(CPos("I8")), CValue()));
    assert (valueMatch(x0.getValue(CPos("I9")), CValue(999999999365.0)));
    assert (valueMatch(x0.getValue(CPos("I10")), CValue(12.0)));
    assert (valueMatch(x0.getValue(CPos("I11")), CValue(0.125)));
    assert (valueMatch(x0.getValue(CPos("I12")), CValue(0.125)));
    assert (valueMatch(x0.getValue(CPos("I13")), CValue(0.125)));
    assert (valueMatch(x0.getValue(CPos("I14")), CValue(15.0)));
    assert (valueMatch(x0.getValue(CPos("I15")), CValue()));
    assert (valueMatch(x0.getValue(CPos("I16")), CValue()));
    assert (valueMatch(x0.getValue(CPos("I17")), CValue(-5.0)));
    assert (valueMatch(x0.getValue(CPos("I18")), CValue(-5.0)));
    assert (valueMatch(x0.getValue(CPos("I19")), CValue(1.0)));
    assert (valueMatch(x0.getValue(CPos("I20")), CValue(10.0)));
    assert (valueMatch(x0.getValue(CPos("I21")), CValue(60.0)));
    assert (valueMatch(x0.getValue(CPos("I22")), CValue(3.0)));
    assert (valueMatch(x0.getValue(CPos("I23")), CValue(1.0)));
    assert (valueMatch(x0.getValue(CPos("I24")), CValue(1.0)));
    assert (valueMatch(x0.getValue(CPos("I25")), CValue(3.0)));
    assert (valueMatch(x0.getValue(CPos("I26")), CValue(1.0)));
    assert (valueMatch(x0.getValue(CPos("I27")), CValue(1.0)));

    assert (valueMatch(x0.getValue(CPos("J9")), CValue(11.0)));
    assert (valueMatch(x0.getValue(CPos("J10")), CValue(1e+12)));
    assert (valueMatch(x0.getValue(CPos("J11")), CValue()));
    assert (valueMatch(x0.getValue(CPos("J12")), CValue()));
    assert (valueMatch(x0.getValue(CPos("J13")), CValue(-24.734375)));
    assert (valueMatch(x0.getValue(CPos("J14")), CValue(2.0)));
    assert (valueMatch(x0.getValue(CPos("J15")), CValue()));
    assert (valueMatch(x0.getValue(CPos("J16")), CValue(19999999987400.0)));
    assert (valueMatch(x0.getValue(CPos("J17")), CValue()));
    assert (valueMatch(x0.getValue(CPos("J18")), CValue(-24.859375)));
    assert (valueMatch(x0.getValue(CPos("J19")), CValue(8.0)));
    assert (valueMatch(x0.getValue(CPos("J20")), CValue(3.0)));
    assert (valueMatch(x0.getValue(CPos("J21")), CValue(1.0)));
    assert (valueMatch(x0.getValue(CPos("J22")), CValue(8.0)));
    assert (valueMatch(x0.getValue(CPos("J23")), CValue(8.0)));
    assert (valueMatch(x0.getValue(CPos("J24")), CValue(8.0)));
    assert (valueMatch(x0.getValue(CPos("J25")), CValue(90.0)));

    assert (valueMatch(x0.getValue(CPos("K10")), CValue(12.0)));
    assert (valueMatch(x0.getValue(CPos("K11")), CValue()));
    assert (valueMatch(x0.getValue(CPos("K12")), CValue()));
    assert (valueMatch(x0.getValue(CPos("K13")), CValue()));
    assert (valueMatch(x0.getValue(CPos("K14")), CValue(3.0)));
    assert (valueMatch(x0.getValue(CPos("K15")), CValue(90.0)));
    assert (valueMatch(x0.getValue(CPos("K16")), CValue(4.0)));
    assert (valueMatch(x0.getValue(CPos("K17")), CValue(5.0)));
    assert (valueMatch(x0.getValue(CPos("K18")), CValue(6.0)));
    assert (valueMatch(x0.getValue(CPos("K19")), CValue(18.0)));
    assert (valueMatch(x0.getValue(CPos("K20")), CValue(999999999370.0)));
    assert (valueMatch(x0.getValue(CPos("K21")), CValue(999999999370.0)));
    assert (valueMatch(x0.getValue(CPos("K22")), CValue(999999999370.0)));
    assert (valueMatch(x0.getValue(CPos("K23")), CValue(999999999370.0)));
    assert (valueMatch(x0.getValue(CPos("K24")), CValue(999999999370.0)));

    assert (valueMatch(x0.getValue(CPos("L10")), CValue(12.0)));
    assert (valueMatch(x0.getValue(CPos("L11")), CValue(14.0)));
    assert (valueMatch(x0.getValue(CPos("L12")), CValue(45.0)));
    assert (valueMatch(x0.getValue(CPos("L13")), CValue(20.0)));
    assert (valueMatch(x0.getValue(CPos("L14")), CValue(0.125)));
    assert (valueMatch(x0.getValue(CPos("L15")), CValue(0.125)));
    assert (valueMatch(x0.getValue(CPos("L16")), CValue(0.125)));
    assert (valueMatch(x0.getValue(CPos("L17")), CValue(9.0)));
    assert (valueMatch(x0.getValue(CPos("L18")), CValue(-16188.0)));
    assert (valueMatch(x0.getValue(CPos("L19")), CValue(-192.0)));
    assert (valueMatch(x0.getValue(CPos("L20")), CValue(7.0)));
    assert (valueMatch(x0.getValue(CPos("L21")), CValue(7.0)));
    assert (valueMatch(x0.getValue(CPos("L22")), CValue()));
    assert (valueMatch(x0.getValue(CPos("L23")), CValue()));
    assert (valueMatch(x0.getValue(CPos("L24")), CValue(455.0)));

    assert (valueMatch(x0.getValue(CPos("M10")), CValue(20.0)));
    assert (valueMatch(x0.getValue(CPos("M11")), CValue(17.0)));
    assert (valueMatch(x0.getValue(CPos("M12")), CValue(45.0)));
    assert (valueMatch(x0.getValue(CPos("M13")), CValue(18.0)));
    assert (valueMatch(x0.getValue(CPos("M14")), CValue(999999999370.0)));
    assert (valueMatch(x0.getValue(CPos("M16")), CValue(-198.875)));
    assert (valueMatch(x0.getValue(CPos("M18")), CValue(-16188.0)));
    assert (valueMatch(x0.getValue(CPos("M19")), CValue(-192.0)));
    assert (valueMatch(x0.getValue(CPos("M20")), CValue(17.0)));
    assert (valueMatch(x0.getValue(CPos("M21")), CValue(300.0)));
    assert (valueMatch(x0.getValue(CPos("M22")), CValue(67.0)));
    assert (valueMatch(x0.getValue(CPos("M23")), CValue(695.0)));
    assert (valueMatch(x0.getValue(CPos("M24")), CValue(456.0)));

    assert (valueMatch(x0.getValue(CPos("N20")), CValue()));
    assert (valueMatch(x0.getValue(CPos("N21")), CValue()));